{"id":"ai-0rl","title":"Config management - .lattice/config.toml read/write/init","description":"Create internal/config/ package. Init creates .lattice/ dir structure and default config.toml. Load/Save handle TOML serialization. Config tracks: session metadata, bead counter, and per-team state (id, type, prefix, agent count, intensity, status, tmux window).","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-11T09:41:04.947073874+11:00","created_by":"kingrea","updated_at":"2026-02-11T10:14:12.864934796+11:00","closed_at":"2026-02-11T10:14:12.864934796+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-0rl","depends_on_id":"ai-js2","type":"blocks","created_at":"2026-02-11T09:43:48.231980074+11:00","created_by":"kingrea"}]}
{"id":"ai-0tj","title":"Launch rewrite - plan-driven epic/role launch with first-role-per-epic spawning","description":"Rewrite launchAudit in internal/tui/launch.go to use the new plan-driven epic/role model instead of the old commissar-per-audit-type approach.\n\n## New launch flow\n1. Call BuildAuditPlan(auditTypes, agentCount, intensity, cfg.BeadCounter)\n2. Set cfg.BeadCounter = plan.FinalCounter\n3. Create tmux session (existing logic)\n4. For each epic in plan:\n   a. Record EpicState in cfg.Epics[auditType.ID]\n   b. For each role in epic:\n      - Record RoleState in cfg.Roles[beadID]\n      - If order == 0 (first role):\n        * GenerateRoleSession\n        * Create tmux window\n        * Send: cd \u003crole-session-dir\u003e \u0026\u0026 opencode run auditor\n        * Set status = \"running\", record TmuxWindow\n      - Else: set status = \"pending\"\n5. Save config (atomic write)\n\n## launchDeps updates\nAdd to launchDeps interface:\n- generateRoleSession func(params RoleSessionParams) (string, error)\n- buildAuditPlan func(...) (*AuditPlan, error)\n\n## launchRequest updates\nAdd focusAreas and target fields if not already present. Remove any fields now derived from the plan.\n\n## Tests (launch_test.go)\n- Tmux windows created ONLY for first roles (order == 0)\n- Config has correct epic states and role states after launch\n- Pending roles recorded but no tmux window/sendkeys\n- BeadCounter advanced to plan.FinalCounter\n- Multiple epics -\u003e multiple windows created in parallel\n\n## Files\n- MODIFY internal/tui/launch.go\n- MODIFY internal/tui/launch_test.go\n\n## Done When\n- launchAudit creates plan, launches first role per epic, records all roles\n- Pending roles have no tmux window\n- Config is saved atomically with all state\n- All tests pass","status":"closed","priority":1,"issue_type":"task","owner":"the.great.jack@gmail.com","created_at":"2026-02-13T10:48:03.963599544+11:00","created_by":"kingrea","updated_at":"2026-02-13T11:21:28.591017858+11:00","closed_at":"2026-02-13T11:21:28.591017858+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-0tj","depends_on_id":"ai-z0y","type":"blocks","created_at":"2026-02-13T10:48:04.093149998+11:00","created_by":"kingrea"},{"issue_id":"ai-0tj","depends_on_id":"ai-nl5","type":"blocks","created_at":"2026-02-13T10:48:04.235373776+11:00","created_by":"kingrea"},{"issue_id":"ai-0tj","depends_on_id":"ai-hwj","type":"blocks","created_at":"2026-02-13T10:48:04.379703964+11:00","created_by":"kingrea"}]}
{"id":"ai-20l","title":"Tmux integration - WSL session/window management","description":"Create internal/tmux/ package. All commands run as wsl tmux since user is on Windows with tmux in WSL. Includes: session create/attach/kill, window create/rename/send-keys, and Windows-to-WSL path translation (G:\\foo -\u003e /mnt/g/foo). Manager detects tmux availability and provides clean exec wrapper.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-11T09:41:12.075831199+11:00","created_by":"kingrea","updated_at":"2026-02-11T10:17:50.2798261+11:00","closed_at":"2026-02-11T10:17:50.2798261+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-20l","depends_on_id":"ai-js2","type":"blocks","created_at":"2026-02-11T09:43:54.923588872+11:00","created_by":"kingrea"}],"comments":[{"id":5,"issue_id":"ai-20l","author":"kingrea","text":"## Core Functions\n- NewManager() - Detect tmux via WSL, return manager\n- CreateSession(name) - wsl tmux new-session -d -s name -n dashboard\n- CreateWindow(session, name) - Add window to session\n- SendKeys(session, window, cmd) - Execute command in window\n- AttachSession(session) - Hand over stdin/stdout for interactive use\n- ListWindows(session) - Get window info for dashboard\n- TranslateToWSLPath(windowsPath) - G:\\Node-Websites -\u003e /mnt/g/Node-Websites\n\n## Done When\n- Can create session, add windows, send keys, and attach\n- Path translation handles drive letters and backslashes","created_at":"2026-02-10T22:41:25Z"}]}
{"id":"ai-5kf","title":"Auto-generate discovery - opencode codebase analysis","description":"Create internal/discovery/discover.go. Runs opencode in the target project to analyze structure and identify 3-10 auditable areas. Outputs JSON with area name, path, description. Parses response with robust JSON extraction (handles opencode preamble). Fallback: manual entry if parsing fails. Integrates into wizard step 0 as an intermediate discovery step.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-11T09:42:29.908979001+11:00","created_by":"kingrea","updated_at":"2026-02-11T11:01:58.154643832+11:00","closed_at":"2026-02-11T11:01:58.154643832+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-5kf","depends_on_id":"ai-20l","type":"blocks","created_at":"2026-02-11T09:45:01.036446803+11:00","created_by":"kingrea"}]}
{"id":"ai-8gd","title":"Audit type registry - define 8 audit types with focus areas and roles","description":"Create internal/teams/audit_types.go with the registry of all 8 audit types. Each type has: ID, name, bead prefix, focus areas (6 per type), 3 role definitions (for 1/2/3 agent configs), and a short description for the TUI.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-11T09:39:49.427396634+11:00","created_by":"kingrea","updated_at":"2026-02-11T10:10:41.198716049+11:00","closed_at":"2026-02-11T10:10:41.198716049+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-8gd","depends_on_id":"ai-js2","type":"blocks","created_at":"2026-02-11T09:43:13.798888163+11:00","created_by":"kingrea"}],"comments":[{"id":3,"issue_id":"ai-8gd","author":"kingrea","text":"## Audit Types (8)\n\n| ID | Name | Prefix | Focus |\n|---|---|---|---|\n| perf | Performance Audit | perf | Render perf, bundle size, network waterfalls |\n| memleak | Memory Leak Audit | mem | Event listener cleanup, closures, timers |\n| lighthouse | Lighthouse Score | lh | Core Web Vitals, a11y, SEO |\n| security | Security Audit | sec | XSS, auth, injection, OWASP |\n| maint | Code Maintainability | maint | Complexity, naming, error handling, test gaps |\n| xbrowser | Cross-browser Issues | xbr | CSS compat, JS APIs, layout engines |\n| a11y | Accessibility Audit | a11y | WCAG, keyboard nav, screen readers |\n| errhandling | Error Handling Audit | err | Unhandled errors, boundaries, retry logic |\n\n## Agent Count -\u003e Role Mapping\n- 1 agent: Senior specialist (alpha only)\n- 2 agents: Senior + Staff (alpha + bravo)\n- 3 agents: Senior + Staff + Domain specialist (alpha + bravo + charlie)\n\n## Done When\n- AuditTypes slice is defined with all 8 types\n- Each type has 6 focus areas and 3 role definitions with guidance text","created_at":"2026-02-10T22:40:05Z"}]}
{"id":"ai-8u4","title":"Integration and backward compat - full test pass and manual e2e verification","description":"Final integration step: ensure everything works together and old configs are not broken.\n\n## Backward compatibility checks\n- Old config.toml files without [epics] or [roles] tables load cleanly (TOML decoder ignores missing sections, nil-map guards initialize empty maps)\n- cfg.Teams map is retained; existing code reading Teams continues to work\n- Old templates/audit/ tree is NOT deleted; remains embedded and available\n- Dashboard falls back to Teams view if Epics is empty\n\n## Test pass\n- Run go test ./... and ensure all tests pass\n- No regressions in existing wizard, menu, multiselect, tmux, config tests\n\n## Manual e2e verification\nFull flow: wizard -\u003e plan built -\u003e first roles launch in tmux -\u003e role completes (set .team status=complete) -\u003e scheduler detects completion -\u003e next role auto-launches -\u003e dashboard shows hierarchy with live status updates -\u003e all roles complete -\u003e completion banner\n\n## Files NOT modified (verify unchanged)\n- internal/tui/audit_wizard.go (wizard collects same inputs)\n- internal/tui/app.go (navigation unchanged)\n- internal/tui/menu.go, multiselect.go, styles.go, keys.go\n- internal/tmux/manager.go (existing ListWindows sufficient)\n- internal/teams/audit_types.go, bead_prefix.go\n- internal/discovery/discover.go\n- templates/audit/ (kept for backward compat)\n\n## Done When\n- go test ./... passes with zero failures\n- Manual e2e confirms full wizard -\u003e scheduler -\u003e completion flow\n- Old configs load without error","status":"closed","priority":2,"issue_type":"task","owner":"the.great.jack@gmail.com","created_at":"2026-02-13T10:49:12.473038322+11:00","created_by":"kingrea","updated_at":"2026-02-13T12:11:37.658473035+11:00","closed_at":"2026-02-13T12:11:37.658473035+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-8u4","depends_on_id":"ai-0tj","type":"blocks","created_at":"2026-02-13T10:49:12.612655726+11:00","created_by":"kingrea"},{"issue_id":"ai-8u4","depends_on_id":"ai-d3k","type":"blocks","created_at":"2026-02-13T10:49:12.73497118+11:00","created_by":"kingrea"}]}
{"id":"ai-a15","title":"Role session template tree - templates/role-session/ with all agent and skill files","description":"Create the new template directory for per-role audit sessions. These replace the old commissar-based team template with a single self-managing auditor agent per session.\n\n## Template files to create\n\n### templates/role-session/.team.tmpl\nteam={{ .TeamName }}\nepic_bead_id={{ .EpicBeadID }}\nrole_bead_id={{ .RoleBeadID }}\nrole={{ .RoleTitle }}\nintensity={{ .Intensity }}\ncurrent_loop=0\nstatus=active\n\n### templates/role-session/INSTRUCTIONS.md.tmpl\nAdapted from current INSTRUCTIONS.md.tmpl. Key changes:\n- Bead prefix is {{ .BeadPrefix }} (role-specific, not team-level)\n- Session completion MUST update .team to status=complete as final mandatory step\n- No references to commissar or multi-investigator coordination\n\n### templates/role-session/context/TASK.md.tmpl\nContains: Epic reference, role title, role guidance, bead prefix, target, focus areas, rules (no manufactured issues, no duplicates, empty audit is valid)\n\n### templates/role-session/DESCRIPTION.md\nExplains the single-role session model\n\n### templates/role-session/opencode.jsonc\nSame as current (opencode-beads plugin)\n\n### templates/role-session/.opencode/agents/auditor.md\nSingle self-managing agent combining commissar loop logic + investigator audit capability:\n- Reads .team for intensity and loop counter\n- Each loop: investigate from role perspective, create/update beads\n- After each loop: increment current_loop in .team\n- Exit early if nothing more to find\n- When done: spawn scribe, follow completion steps, set .team status=complete\n\n### templates/role-session/.opencode/agents/scribe.md\nSame as current scribe template\n\n### templates/role-session/.opencode/skills/\n- audit-prompt/SKILL.md - adapted for single role\n- loop-prompt/SKILL.md - adapted for single role\n- compile-report/SKILL.md - same as current\n\n## Embed update\nUpdate templates/embed.go to add:\n  //go:embed all:role-session\n  var RoleSessionTemplate embed.FS\n\n## Files\n- CREATE templates/role-session/ (full tree)\n- MODIFY templates/embed.go\n\n## Done When\n- All template files exist and are syntactically valid Go templates\n- embed.go compiles with both template trees\n- No commissar or investigator references in role-session templates\n- auditor.md contains loop logic and completion protocol","status":"closed","priority":1,"issue_type":"task","owner":"the.great.jack@gmail.com","created_at":"2026-02-13T10:47:35.027454347+11:00","created_by":"kingrea","updated_at":"2026-02-13T11:07:00.850056581+11:00","closed_at":"2026-02-13T11:07:00.850056581+11:00","close_reason":"Closed"}
{"id":"ai-a7f","title":"Dashboard - post-launch team status view","description":"Create internal/tui/dashboard.go. Shows all running teams with status, current loop/intensity, and agent count. Periodically reads .team files from each team folder. Keybindings: [t] suspend bubbletea and attach tmux (returns on Ctrl+B D), [r] refresh status, [q] quit lattice (tmux keeps running). Shows LATTICE branding and session name.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-11T09:42:45.270912504+11:00","created_by":"kingrea","updated_at":"2026-02-11T10:53:43.20402506+11:00","closed_at":"2026-02-11T10:53:43.20402506+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-a7f","depends_on_id":"ai-muq","type":"blocks","created_at":"2026-02-11T09:45:36.805556915+11:00","created_by":"kingrea"},{"issue_id":"ai-a7f","depends_on_id":"ai-e3f","type":"blocks","created_at":"2026-02-11T09:45:43.38343746+11:00","created_by":"kingrea"}]}
{"id":"ai-b3i","title":"Dashboard epic/role view - hierarchical display replacing flat team view","description":"Replace the flat team status display in internal/tui/dashboard.go with a hierarchical epic/role view.\n\n## New snapshot structs\n\ndashboardEpicStatus:\n  EpicName, BeadID, AuditType, Status string\n  RolesTotal, RolesComplete, RolesFailed int\n  Roles []dashboardRoleStatus\n\ndashboardRoleStatus:\n  BeadID, CodeName, Title, Status string\n  CurrentLoop, Intensity int\n  BeadPrefix string\n\n## View layout\nLATTICE\nPost-launch Audit Status\n\nSession: lattice-20260212-143201\nLast refresh: 2:32 PM\n\nEPIC                      STATUS     PROGRESS\nPerformance Audit         running    1/3 roles done\n  alpha (Sr. Perf Spec)   complete   loop 3/3\n  bravo (Staff Perf Eng)  running    loop 1/3\n  charlie (Runtime Opt)   pending    -\nSecurity Audit            running    0/2 roles done\n  alpha (Sr. Sec Spec)    running    loop 2/3\n  bravo (Staff AppSec)    pending    -\n\nt: attach tmux  r: refresh  esc: menu  q: quit\n\n## Changes\n- Replace dashboardTeamStatus with dashboardEpicStatus/dashboardRoleStatus\n- Update loadDashboardSnapshot to read from cfg.Epics and cfg.Roles\n- Rename renderTeamTable -\u003e renderEpicTable with indented role rows\n- Backward compat: if cfg.Epics is empty but cfg.Teams is not, fall back to old team view\n\n## Tests (dashboard_test.go)\n- Snapshot correctly reads epic/role state from config\n- Render shows hierarchical epic -\u003e role layout\n- Role status correctly displays loop progress\n- Backward compat: old Teams-only config renders without crash\n\n## Files\n- MODIFY internal/tui/dashboard.go\n- MODIFY internal/tui/dashboard_test.go\n\n## Done When\n- Dashboard shows epic/role hierarchy\n- Each role shows status + loop progress\n- Epic shows derived status and completion ratio\n- Backward compat with old configs\n- All tests pass","status":"closed","priority":1,"issue_type":"task","owner":"the.great.jack@gmail.com","created_at":"2026-02-13T10:48:41.2474012+11:00","created_by":"kingrea","updated_at":"2026-02-13T11:16:50.977678815+11:00","closed_at":"2026-02-13T11:16:50.977678815+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-b3i","depends_on_id":"ai-nl5","type":"blocks","created_at":"2026-02-13T10:48:41.386719095+11:00","created_by":"kingrea"}]}
{"id":"ai-cvz","title":"TUI styles and key bindings","description":"Create internal/tui/styles.go (lipgloss styles for headers, lists, selections, etc.) and internal/tui/keys.go (key binding definitions for navigation). Foundation for all TUI components.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-11T09:41:46.720470859+11:00","created_by":"kingrea","updated_at":"2026-02-11T10:27:08.512395336+11:00","closed_at":"2026-02-11T10:27:08.512395336+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-cvz","depends_on_id":"ai-js2","type":"blocks","created_at":"2026-02-11T09:44:06.519108827+11:00","created_by":"kingrea"}]}
{"id":"ai-d3k","title":"Dashboard scheduler wiring - integrate scheduler into dashboard tick loop","description":"Wire CheckAndAdvanceRoles into the dashboard so roles auto-advance on each tick.\n\n## Integration point\nOn each dashboardTickMsg (3-second interval):\n1. Call CheckAndAdvanceRoles(cwd, cfg, sessionName, plan, deps)\n2. If roles were launched/completed/failed -\u003e emit schedulerAdvancedMsg with the SchedulerResult\n3. Dashboard Update handler processes schedulerAdvancedMsg and refreshes the view\n4. If AllDone -\u003e show completion banner\n\n## New message type\nschedulerAdvancedMsg struct containing the SchedulerResult from the scheduler.\n\n## Decision 2 rationale\nThe scheduler runs inside the dashboard tick, NOT as a background daemon. This is intentional:\n- Opencode sessions run in tmux regardless of TUI being open\n- Work continues; only role advancement pauses when TUI is closed\n- Recovery model (Decision 4) ensures restarting TUI picks up exactly where it left off\n- No work is lost; worst case is a delay between role completions\n\n## Tests\n- Tick triggers scheduler check\n- Scheduler result updates dashboard state\n- Completion banner shown when AllDone is true\n- Failed roles display clearly in dashboard\n\n## Files\n- MODIFY internal/tui/dashboard.go (add scheduler call in tick handler, add message type)\n- MODIFY internal/tui/dashboard_test.go\n\n## Done When\n- Dashboard tick calls scheduler and processes results\n- Roles auto-advance when previous role completes\n- Completion banner shows when all done\n- Failed roles visible and epic shows as blocked\n- All tests pass","status":"closed","priority":1,"issue_type":"task","owner":"the.great.jack@gmail.com","created_at":"2026-02-13T10:48:56.58477432+11:00","created_by":"kingrea","updated_at":"2026-02-13T12:08:53.190835056+11:00","closed_at":"2026-02-13T12:08:53.190835056+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-d3k","depends_on_id":"ai-z1j","type":"blocks","created_at":"2026-02-13T10:48:56.728405702+11:00","created_by":"kingrea"},{"issue_id":"ai-d3k","depends_on_id":"ai-b3i","type":"blocks","created_at":"2026-02-13T10:48:56.849842206+11:00","created_by":"kingrea"}]}
{"id":"ai-e3f","title":"App model - top-level screen routing","description":"Create internal/tui/app.go. Top-level bubbletea model that routes between screens: MenuScreen, WizardScreen, DashboardScreen. Handles window resize, navigation messages, and delegates Update/View to the active screen sub-model. Entry point: NewApp(cwd string).","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-11T09:42:15.491286659+11:00","created_by":"kingrea","updated_at":"2026-02-11T10:42:37.398331226+11:00","closed_at":"2026-02-11T10:42:37.398331226+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-e3f","depends_on_id":"ai-x5s","type":"blocks","created_at":"2026-02-11T09:44:41.636638402+11:00","created_by":"kingrea"},{"issue_id":"ai-e3f","depends_on_id":"ai-rkj","type":"blocks","created_at":"2026-02-11T09:44:49.1750041+11:00","created_by":"kingrea"}]}
{"id":"ai-hvn","title":"Bead prefix allocator - unique prefix per team","description":"Create internal/teams/bead_prefix.go. Allocates unique prefixes using format {type-prefix}-{global-counter}. Counter stored in .lattice/config.toml and incremented per team. Ensures uniqueness across multiple lattice runs (e.g. perf-1, sec-2, perf-3).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-11T09:40:17.91196422+11:00","created_by":"kingrea","updated_at":"2026-02-11T10:20:33.377157614+11:00","closed_at":"2026-02-11T10:20:33.377157614+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-hvn","depends_on_id":"ai-js2","type":"blocks","created_at":"2026-02-11T09:43:20.945989833+11:00","created_by":"kingrea"}]}
{"id":"ai-hwj","title":"Role session generator - GenerateRoleSession function and tests","description":"Add the ability to generate per-role session folders from the new role-session template tree.\n\n## New types in internal/teams/generator.go\n\nRoleSessionParams struct:\n  Cwd, EpicBeadID, RoleBeadID, RoleTitle, RoleGuidance string\n  Intensity int\n  BeadPrefix, Target string\n  FocusAreas []string\n  AuditTypeID string  // used to build TeamName (e.g. \"perf-alpha\")\n  CodeName string\n\nRoleSessionData struct (template render context):\n  TeamName, EpicBeadID, RoleBeadID, RoleTitle, RoleGuidance string\n  Intensity int\n  BeadPrefix, Target string\n  FocusAreas []string\n\n## GenerateRoleSession function\nSignature: GenerateRoleSession(params RoleSessionParams) (string, error)\n- Builds TeamName from AuditTypeID + \"-\" + CodeName\n- Creates output dir under cwd (same pattern as existing GenerateTeamFolder)\n- Walks templates/role-session/ with RoleSessionData\n- Returns path to generated folder\n\n## Tests (generator_test.go)\n- .team file contains epic bead ID, role bead ID, role title, correct intensity\n- context/TASK.md contains role perspective, guidance, focus areas\n- INSTRUCTIONS.md contains correct bead prefix\n- auditor.md and scribe.md exist\n- No commissar or investigator files\n- TeamName is correctly formatted\n\n## Files\n- MODIFY internal/teams/generator.go (add types + function)\n- MODIFY internal/teams/generator_test.go (add tests)\n\n## Done When\n- GenerateRoleSession produces a working session folder\n- All template variables are correctly substituted\n- Tests verify file contents, not just existence","status":"closed","priority":1,"issue_type":"task","owner":"the.great.jack@gmail.com","created_at":"2026-02-13T10:47:48.155203206+11:00","created_by":"kingrea","updated_at":"2026-02-13T11:10:05.311969184+11:00","closed_at":"2026-02-13T11:10:05.311969184+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-hwj","depends_on_id":"ai-z0y","type":"blocks","created_at":"2026-02-13T10:47:48.274263643+11:00","created_by":"kingrea"},{"issue_id":"ai-hwj","depends_on_id":"ai-a15","type":"blocks","created_at":"2026-02-13T10:47:48.406806342+11:00","created_by":"kingrea"}]}
{"id":"ai-jqx","title":"Multi-select TUI component","description":"Create internal/tui/multiselect.go. Reusable multi-select list component for bubbletea. Features: j/k or up/down navigation, space to toggle, enter to confirm, a to select all. Each item has Label, Description, Selected bool, and generic Value. Used for audit type selection.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-11T09:41:53.707908322+11:00","created_by":"kingrea","updated_at":"2026-02-11T10:30:13.19761775+11:00","closed_at":"2026-02-11T10:30:13.19761775+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-jqx","depends_on_id":"ai-cvz","type":"blocks","created_at":"2026-02-11T09:44:13.241235595+11:00","created_by":"kingrea"}]}
{"id":"ai-js2","title":"Project scaffolding - Go module, deps, hello-world bubbletea","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-11T09:38:53.803830249+11:00","created_by":"kingrea","updated_at":"2026-02-11T10:02:20.909095032+11:00","closed_at":"2026-02-11T10:02:20.909095032+11:00","close_reason":"Closed","comments":[{"id":1,"issue_id":"ai-js2","author":"kingrea","text":"## What\nCreate the Go module, install dependencies, and get a basic bubbletea app running.\n\n## Files\n- main.go - Entry point, gets cwd, launches bubbletea with alt-screen\n- go.mod - Module lattice\n\n## Dependencies\n- charmbracelet/bubbletea - TUI framework\n- charmbracelet/lipgloss - TUI styling\n- charmbracelet/bubbles - TUI components (spinner, list)\n- BurntSushi/toml - Config file parsing\n\n## Done When\n- go build succeeds\n- Running binary shows alt-screen TUI with placeholder message","created_at":"2026-02-10T22:39:08Z"}]}
{"id":"ai-lmv","title":"Template embedding system - embed team-audit as Go templates","description":"Copy team-audit/ into templates/audit/, create .tmpl variants for dynamic files (.team, INSTRUCTIONS.md, TASK.md), wire up embed.FS with all: prefix for dotfiles. Static agent/skill files copy verbatim. Only 3 files need templating.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-11T09:39:21.460606099+11:00","created_by":"kingrea","updated_at":"2026-02-11T10:06:48.010660125+11:00","closed_at":"2026-02-11T10:06:48.010660125+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-lmv","depends_on_id":"ai-js2","type":"blocks","created_at":"2026-02-11T09:43:07.227311312+11:00","created_by":"kingrea"}],"comments":[{"id":2,"issue_id":"ai-lmv","author":"kingrea","text":"## Files\n- templates/embed.go - //go:embed all:audit directive\n- templates/audit/ - Full copy of team-audit/ structure\n- templates/audit/.team.tmpl - Templated: team name, intensity\n- templates/audit/INSTRUCTIONS.md.tmpl - Existing content + bead prefix section\n- templates/audit/context/TASK.md.tmpl - Templated: target, roles, focus areas, bead prefix\n\n## Key Detail\nThe all: prefix in go:embed is critical - without it, dotfiles (.team, .opencode/) are silently excluded.\n\nAgent .md files and skill SKILL.md files are static - they read TASK.md at runtime for dynamic info.\n\n## Done When\n- templates.AuditTemplate.ReadDir works and returns all files including dotfiles\n- .tmpl files render correctly with test data","created_at":"2026-02-10T22:39:36Z"}]}
{"id":"ai-muq","title":"Launch orchestration - wire wizard to generator and tmux","description":"Wire the audit wizard step 5 to: 1) config.Init(cwd), 2) tmux.NewManager(), 3) tmux.CreateSession(lattice-timestamp), 4) for each selected audit type: allocate bead prefix, generate team folder, create tmux window, send-keys to cd + opencode run commissar, 5) config.Save(). Produces LaunchCompleteMsg to transition to dashboard.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-11T09:42:37.881975874+11:00","created_by":"kingrea","updated_at":"2026-02-11T10:47:51.896967927+11:00","closed_at":"2026-02-11T10:47:51.896967927+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-muq","depends_on_id":"ai-wnh","type":"blocks","created_at":"2026-02-11T09:45:08.485562704+11:00","created_by":"kingrea"},{"issue_id":"ai-muq","depends_on_id":"ai-0rl","type":"blocks","created_at":"2026-02-11T09:45:15.161799313+11:00","created_by":"kingrea"},{"issue_id":"ai-muq","depends_on_id":"ai-20l","type":"blocks","created_at":"2026-02-11T09:45:21.740655005+11:00","created_by":"kingrea"},{"issue_id":"ai-muq","depends_on_id":"ai-rkj","type":"blocks","created_at":"2026-02-11T09:45:28.96843899+11:00","created_by":"kingrea"}]}
{"id":"ai-nl5","title":"Config epic/role state - Epics and Roles maps, atomic Save, nil-map guards","description":"Extend internal/config/config.go to persist epic and role orchestration state.\n\n## New structs\n- EpicState: BeadID, AuditType, AuditName, AgentCount, Intensity, Status (derived: running/complete/failed)\n- RoleState: BeadID, EpicBeadID, CodeName, Title, Guidance, BeadPrefix, Order, Status (pending/running/complete/failed), TmuxWindow, Intensity\n\n## Config struct changes\nAdd to Config:\n  Epics map[string]EpicState (toml:\"epics\")\n  Roles map[string]RoleState (toml:\"roles\")\nKeep existing Teams map for backward compat.\n\n## Nil-map guards\nIn Load() and Save(), initialize nil maps to empty (same pattern as existing Teams field).\n\n## Atomic Save\nUpdate Config.Save() to write-to-temp-then-rename:\n  1. Write to config.toml.tmp\n  2. os.Rename(tmp, filePath)\nPrevents corruption on crash. Safe because Bubble Tea update loop is single-threaded and opencode sessions write to .team files, not config.toml.\n\n## Single counter (Decision 3)\nUse existing BeadCounter for everything. No separate PlanCounter. BuildAuditPlan takes startCounter, returns FinalCounter, caller writes it back.\n\n## Tests (config_test.go)\n- Round-trip: save config with Epics+Roles populated, reload, verify\n- Backward compat: load old config without epics/roles fields -\u003e empty maps, no error\n- Atomic write: verify temp file is cleaned up on success\n- Nil-map guards: save/load with nil maps -\u003e empty maps\n\n## Files\n- MODIFY internal/config/config.go\n- MODIFY internal/config/config_test.go\n\n## Done When\n- EpicState and RoleState round-trip through TOML correctly\n- Old configs without epics/roles load cleanly\n- Save uses atomic write-then-rename\n- All tests pass","status":"closed","priority":1,"issue_type":"task","owner":"the.great.jack@gmail.com","created_at":"2026-02-13T10:47:15.017734981+11:00","created_by":"kingrea","updated_at":"2026-02-13T11:01:57.711539323+11:00","closed_at":"2026-02-13T11:01:57.711539323+11:00","close_reason":"Closed"}
{"id":"ai-rkj","title":"Audit wizard - 6-step configuration flow","description":"Create internal/tui/audit_wizard.go. Multi-step wizard: Step 0 (mode: manual/auto-generate), Step 1 (multi-select audit types from 8 options), Step 2 (agent count: 1/2/3), Step 3 (rigor: Light 1 loop / Standard 3 / Go Hard 99), Step 4 (confirmation summary), Step 5 (generating spinner + launch). Enter advances, Esc goes back.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-11T09:42:08.556814249+11:00","created_by":"kingrea","updated_at":"2026-02-11T10:37:36.24091124+11:00","closed_at":"2026-02-11T10:37:36.24091124+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-rkj","depends_on_id":"ai-jqx","type":"blocks","created_at":"2026-02-11T09:44:27.630585774+11:00","created_by":"kingrea"},{"issue_id":"ai-rkj","depends_on_id":"ai-8gd","type":"blocks","created_at":"2026-02-11T09:44:34.938058603+11:00","created_by":"kingrea"}]}
{"id":"ai-wnh","title":"Team folder generator - walk embedded FS and produce team dirs","description":"Create internal/teams/generator.go. Walks the embedded template FS, renders .tmpl files with audit-specific data (target, roles, focus areas, bead prefix, intensity), copies static files verbatim, and skips unused investigator files based on agent count. Produces a complete team folder in .lattice/teams/audit-{type}/.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-11T09:40:30.342384992+11:00","created_by":"kingrea","updated_at":"2026-02-11T10:24:38.071827503+11:00","closed_at":"2026-02-11T10:24:38.071827503+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-wnh","depends_on_id":"ai-lmv","type":"blocks","created_at":"2026-02-11T09:43:28.484049088+11:00","created_by":"kingrea"},{"issue_id":"ai-wnh","depends_on_id":"ai-8gd","type":"blocks","created_at":"2026-02-11T09:43:35.094237212+11:00","created_by":"kingrea"},{"issue_id":"ai-wnh","depends_on_id":"ai-hvn","type":"blocks","created_at":"2026-02-11T09:43:41.681318097+11:00","created_by":"kingrea"}],"comments":[{"id":4,"issue_id":"ai-wnh","author":"kingrea","text":"## Key Logic\n- fs.WalkDir on embedded templates.AuditTemplate\n- Strip \"audit/\" prefix from paths to compute output paths\n- Strip .tmpl extension from output paths\n- Render .tmpl files with text/template using TemplateData struct\n- Copy non-.tmpl files verbatim\n- Skip investigator-bravo.md when agentCount \u003c 2\n- Skip investigator-charlie.md when agentCount \u003c 3\n\n## TemplateData struct\n- TeamName, Intensity, BeadPrefix, Target string\n- Roles []Role (only active roles for chosen agent count)\n- FocusAreas []string\n\n## Done When\n- Generate() produces complete folder with correct .team, TASK.md, INSTRUCTIONS.md\n- Correct number of investigator files based on agent count\n- All static files (agents, skills, DESCRIPTION.md, opencode.jsonc) present","created_at":"2026-02-10T22:40:46Z"}]}
{"id":"ai-x5s","title":"Main menu TUI model","description":"Create internal/tui/menu.go. Simple list menu with options: Audit, Quit (Action is future work). Selecting Audit navigates to the audit wizard. Clean header with LATTICE branding.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-11T09:42:01.190466596+11:00","created_by":"kingrea","updated_at":"2026-02-11T10:33:08.476074845+11:00","closed_at":"2026-02-11T10:33:08.476074845+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-x5s","depends_on_id":"ai-cvz","type":"blocks","created_at":"2026-02-11T09:44:19.928135647+11:00","created_by":"kingrea"}]}
{"id":"ai-z0y","title":"Audit plan builder - BuildAuditPlan, EpicBead, RoleBead structs and slugify","description":"Create internal/teams/plan.go with the core planning data model and builder function.\n\n## Structs\n- RoleBead: BeadID, CodeName, Title, Guidance, BeadPrefix, Order\n- EpicBead: BeadID, AuditType, RoleBeads (ordered slice)\n- AuditPlan: Epics slice, FinalCounter int\n\n## BuildAuditPlan function\nSignature: BuildAuditPlan(auditTypes []AuditType, agentCount int, intensity int, startCounter int) (*AuditPlan, error)\n\nAlgorithm:\n1. Validate: at least 1 audit type, agentCount 1-3, intensity \u003e= 1\n2. counter := startCounter\n3. For each audit type: counter++ for epic ID (audit-plan-NNN), then counter++ per role\n4. Look up RoleConfigs for given agentCount. Error if not found.\n5. Derive BeadPrefix = auditType.BeadPrefix + \"-\" + slugify(role.Title)\n6. Return AuditPlan with all epics and FinalCounter\n\n## slugify helper\n1. Lowercase  2. Replace spaces with hyphens  3. Remove non-alphanumeric-non-hyphen  4. Collapse consecutive hyphens  5. Truncate to 30 chars at word boundary\n\n## Tests (plan_test.go)\n- 1 audit type, 1 agent -\u003e 1 epic, 1 role\n- 2 audit types, 3 agents -\u003e 2 epics, 3+3 roles\n- Sequential IDs: audit-plan-001, 002, ...\n- Correct bead prefix derivation\n- Error on 0 audit types, invalid agent count\n- UNIQUENESS TEST: all prefixes across all audit types x all agent counts are unique\n\n## Files\n- CREATE internal/teams/plan.go\n- CREATE internal/teams/plan_test.go\n\n## Done When\n- BuildAuditPlan returns correct plan for all agent counts\n- slugify produces valid, truncated slugs\n- All tests pass including uniqueness assertion","status":"closed","priority":1,"issue_type":"task","owner":"the.great.jack@gmail.com","created_at":"2026-02-13T10:46:59.593448593+11:00","created_by":"kingrea","updated_at":"2026-02-13T10:59:37.851699658+11:00","closed_at":"2026-02-13T10:59:37.851699658+11:00","close_reason":"Closed"}
{"id":"ai-z1j","title":"Role scheduler - CheckAndAdvanceRoles with idempotent state machine","description":"Create internal/tui/scheduler.go implementing the role state machine and advancement logic.\n\n## Role state machine (Decision 4)\n  pending -\u003e running -\u003e complete\n                    \\-\u003e failed\nNo automatic retry. No timeout. No stalled state.\n\n## Key types\n\nSchedulerDeps struct:\n  GenerateRoleSession func(params RoleSessionParams) (string, error)\n  TranslatePath       func(path string) (string, error)\n  TmuxManager         launchTmuxManager\n  CheckTmuxWindow     func(sessionName, windowName string) bool\n  Now                 func() time.Time\n\nSchedulerResult struct:\n  Launched  []ScheduledRole  // roles that were started this tick\n  Completed []string         // role bead IDs marked complete\n  Failed    []string         // role bead IDs marked failed\n  AllDone   bool             // true if every role is complete or failed\n\n## CheckAndAdvanceRoles function\nSignature: CheckAndAdvanceRoles(cwd string, cfg *config.Config, sessionName string, plan *AuditPlan, deps SchedulerDeps) (SchedulerResult, error)\n\n## Idempotent rules (Decision 5) - per role:\n1. running + tmux window exists -\u003e do nothing\n2. running + window gone + .team status=complete -\u003e mark complete, check next\n3. running + window gone + .team status!=complete -\u003e mark failed\n4. pending + previous role complete -\u003e launch it (generate folder, create window, send keys, mark running)\n5. pending + previous role failed -\u003e do nothing (epic blocked)\n6. complete or failed -\u003e do nothing\n\n## CheckTmuxWindow\nNew helper using tmux list-windows to check window existence. This is the crash detection mechanism. Injected via SchedulerDeps for testability.\n\n## Epic status derivation\n- running: any role is running or pending\n- complete: all roles complete\n- failed: any role failed and no role running\n\n## Tests (scheduler_test.go)\n- Running role completes -\u003e next role launches\n- Running role window disappears without completion -\u003e marked failed\n- Last role completes -\u003e AllDone true, epic derived as complete\n- Role fails -\u003e subsequent pending roles stay pending (epic blocked)\n- Idempotent: calling twice with same state -\u003e no duplicate launches\n- Crash recovery: role marked running but window gone -\u003e detected as failed\n- Multiple epics advance independently\n\n## Files\n- CREATE internal/tui/scheduler.go\n- CREATE internal/tui/scheduler_test.go\n\n## Done When\n- All 6 idempotent rules correctly implemented\n- State transitions match the state machine exactly\n- Crash recovery works (running + no window -\u003e failed)\n- No duplicate launches on repeated calls\n- All tests pass","status":"closed","priority":1,"issue_type":"task","owner":"the.great.jack@gmail.com","created_at":"2026-02-13T10:48:24.230941817+11:00","created_by":"kingrea","updated_at":"2026-02-13T11:26:31.583256999+11:00","closed_at":"2026-02-13T11:26:31.583256999+11:00","close_reason":"Closed","dependencies":[{"issue_id":"ai-z1j","depends_on_id":"ai-nl5","type":"blocks","created_at":"2026-02-13T10:48:24.364002641+11:00","created_by":"kingrea"},{"issue_id":"ai-z1j","depends_on_id":"ai-hwj","type":"blocks","created_at":"2026-02-13T10:48:24.506827802+11:00","created_by":"kingrea"}]}
